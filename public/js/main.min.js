const months=["January","February","March","April","May","June","July","August","September","October","November","December"];function formatTime(e){let t=e.substring(0,2);const n=e.substring(3,5),l=t<12?"am":"pm";return t=(t=0==t?12:t)<10?t.slice(1,2):t,`${t="pm"===l?t%12:t}:${n} ${l}`}function formatDate(e){let t=e.substring(5,7),n=e.substring(8,10);const l=e.substring(0,4);return t=t<10?t.slice(1,2):t,n=n<10?n.slice(1,2):n,`${months[t-1]} ${n}, ${l}`}function logout(){firebase.auth().signOut().then(function(){window.location.href="index.min.html"}).catch(function(e){alert(e)})}function toggleSidebar(){document.getElementById("sidebar").classList.toggle("active")}function close(){document.getElementsByClassName("modal-list")[0].innerHTML="",document.getElementsByClassName("modal-list")[1].innerHTML="",document.getElementsByClassName("modal-list")[2].innerHTML="",document.getElementsByClassName("trash")[0].innerHTML="",document.getElementsByClassName("modal")[0].style.display="none",document.getElementsByClassName("modal")[1].style.display="none",document.getElementsByClassName("modal")[2].style.display="none"}function closeOutside(e){"modal"===e.target.className&&close()}function viewTodo(){window.location.href="home.min.html"}function viewCompleted(){window.location.href="completed.min.html"}function revise(e,t,n){const l=document.getElementById("title").value,o=document.getElementById("date").value,a=document.getElementById("time").value,i=document.getElementById("description").value;if(""===l||""===o||""===a)return void alert("You must enter a title, date, and time.");const s=Date.parse(o+" "+a)/1e3;void 0!==s&&""!==s||(s=0);const c=firebase.auth().currentUser;n?database.collection("users").doc(c.uid).collection("todo").doc().set({title:l,date:o,time:a,description:i,timestamp:s}).then(function(){document.getElementsByClassName("modal-list")[1].innerHTML="",location.reload()}).catch(function(e){console.log("Error: "+e)}):database.collection("users").doc(c.uid).collection(t).doc(e).set({title:l,date:o,time:a,description:i,timestamp:s}).then(function(){document.getElementsByClassName("modal-list")[0].innerHTML="",location.reload()}).catch(function(e){console.log("Error: "+e)})}function displayViewScreen(e,t){const n=e.slice(5),l=firebase.auth().currentUser.uid;let o,a,i,s;document.getElementsByClassName("modal")[0].style.display="block",database.collection("users").doc(l).collection(t).doc(n).get().then(function(e){if(e.exists){o=formatDate(e.data().date),i=e.data().description,a=formatTime(e.data().time),s=e.data().title,titleArr=s.split(" ");var t=`<h2 class=view-info>\n                            <span class=header>Title: </span>\n                            ${titleArr.join("&nbsp;")}</h2><br>\n                        <h2 class=view-info>\n                            <span class=header>Date: </span>\n                            ${o}</h2><br>\n                        <h2 class=view-info>\n                            <span class=header>Time: </span>\n                            ${a}</h2><br>\n                        ${""===i?"":`<h2 class=view-info bottom-view>    \n                            <span class=header>Description: </span>\n                            ${i}</h2><br>`}\n                        <button disabled id=view style="color:#a3a8c2">View</button>`;document.getElementsByClassName("modal-list")[0].innerHTML=t}})}function displayEditScreen(e,t){const n=e.slice(5),l=firebase.auth().currentUser.uid;let o,a,i,s;document.getElementsByClassName("modal")[1].style.display="block",database.collection("users").doc(l).collection(t).doc(n).get().then(function(e){if(e.exists){o=e.data().date,i=e.data().description,a=e.data().time,s=e.data().title,titleArr=s.split(" "),"\n          <img\n            src='images/trash.png'\n            alt='Delete'\n            onclick={deleteTask(clickedID, type, true)}\n          />";var l=`<label for=title>Title</label>\n                    <input type=text id=title name=title placeholder='Enter a title' value=${titleArr.join("&nbsp;")}\n                    )}><br>\n                    <label for=date>Date</label>\n                    <input type=date id=date name=date placeholder='Enter a date' value=${o}><br>\n                    <label for=time>Time</label>\n                    <input type=time id=time name=time placeholder='Enter a time' value=${a}><br>\n                    <label for=description>Description</label>\n                    <textarea id=description name=description placeholder='Enter a description'>${i}</textarea><br>\n                    <button id=revise onclick="revise( '${n}', '${t}', false )">Revise</button>`,c=`<img onclick="deleteTask('${n}', '${t}', true)" src='images/trash.png' alt=Delete>`;document.getElementsByClassName("modal-list")[1].innerHTML=l,document.getElementsByClassName("trash")[0].innerHTML=c}})}function displayCreateScreen(){document.getElementsByClassName("modal")[2].style.display="block";document.getElementsByClassName("modal-list")[2].innerHTML="<label for=title>Title</label>\n    <input type=text id=title name=title placeholder='Enter a title' value=''><br>\n    <label for=date>Date</label>\n    <input type=date id=date name=date placeholder='Enter a date' value=''><br>\n    <label for=time>Time</label>\n    <input type=time id=time name=time placeholder='Enter a time' value=''><br>\n    <label for=description>Description</label>\n    <textarea id=description name=description placeholder='Enter a description'></textarea><br>\n    <button id='create' onclick=\"revise( '', 'todo', true )\">Create</button>"}function completeTask(e){if(!confirm("Mark task as complete?"))return;const t=e.slice(5),n=firebase.auth().currentUser.uid;let l,o,a,i,s;database.collection("users").doc(n).collection("todo").doc(t).get().then(function(e){e.exists&&(l=e.data().date,o=e.data().time,a=e.data().description,i=e.data().timestamp,s=e.data().title,database.collection("users").doc(n).collection("completed").doc(t).set({date:l,time:o,description:a,timestamp:i,title:s}).then(function(){database.collection("users").doc(n).collection("todo").doc(t).delete().then(function(){console.log("Successfully moved document to completed section"),document.getElementById(t).style.display="none"}).catch(function(e){console.log("Error moving document: ",e)})}))})}function deleteTask(e,t,n){if(!confirm("Delete this task?"))return;const l=n?e:e.slice(5),o=firebase.auth().currentUser.uid;database.collection("users").doc(o).collection(t).doc(l).delete().then(function(){console.log("Successfully deleted document"),document.getElementById(l).style.display="none",n&&close()}).catch(function(e){console.log("Error removing document: ",e)})}window.onload=function(){document.getElementById("signout").addEventListener("click",logout),document.getElementById("hamburger").addEventListener("click",toggleSidebar),document.getElementById("createbtn").addEventListener("click",displayCreateScreen),document.getElementsByClassName("close")[0].addEventListener("click",close),document.getElementsByClassName("close")[1].addEventListener("click",close),document.getElementsByClassName("close")[2].addEventListener("click",close),window.addEventListener("click",closeOutside),void 0!==document.getElementById("todo")&&document.getElementById("todo").addEventListener("click",viewTodo),void 0!==document.getElementById("completed")&&document.getElementById("completed").addEventListener("click",viewCompleted)};